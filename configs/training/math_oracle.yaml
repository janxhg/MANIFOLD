# Math Oracle Training Configuration
# Optimized for RTX 4090 (Large Batch Stability)

training:
  dataset: "math"
  dataset_size: 10_000_000
  max_digits: 8
  seq_len: 128

  # RTX 4090 Settings (24GB VRAM + Adjoint O(1) Memory)
  # We can push physical batch size very high.
  batch_size: 4096       
  accumulation_steps: 2  
  effective_batch: 8192  # Stable Gradient Descent territory

  # Learning Rate Adjustment
  # For Batch 8192, we scale up slightly but respect Manifold curvature.
  learning_rate: 1.0e-3  # Perfect balance for stability/speed with RiemannianAdam
  weight_decay: 0.1
  max_grad_norm: 1.0

  epochs: 1000             # Increased epochs for full convergence
  steps_per_epoch: 1000
  log_interval: 10
  demo_interval: 1

  use_amp: true
  compile: false         # Windows/Triton limitation

checkpoint:
  save_interval: 1
  path: "checkpoints/math_oracle"
